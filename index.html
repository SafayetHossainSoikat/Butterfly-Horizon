document.addEventListener("DOMContentLoaded", function () {
    let inventory = 500;
    const maxInventory = 500;
    const rechargeTime = 3600000; // 1 hour
    let clickCount = 0; // Click counter

    function startVibration() {
        if ("vibrate" in navigator) {
            window.navigator.vibrate(20);
        }
    }

    function handleClick() {
        if (inventory > 0.00002) {
            clickCount++; // Increase Click Count

            let coins = Number(localStorage.getItem('coins')) || 0;
            coins += 0.00002;
            localStorage.setItem('coins', coins);
            inventory -= 0.00002;
            
            document.getElementById('score').textContent = `$ ${coins.toFixed(5)}`;
            updateInventory();
            startVibration();

            const image = document.querySelector('.clickable');
            image.classList.add('shake');
            setTimeout(() => {
                image.classList.remove('shake');
            }, 500);

            // Score Animation
            const scoreDisplay = document.createElement('div');
            scoreDisplay.textContent = "+0.00002";
            scoreDisplay.classList.add('score-display');
            document.body.appendChild(scoreDisplay);
            const rect = image.getBoundingClientRect();
            scoreDisplay.style.left = `${rect.left + rect.width / 2}px`;
            scoreDisplay.style.top = `${rect.top}px`;
            setTimeout(() => {
                scoreDisplay.remove();
            }, 1000);

            if (inventory <= 0) {
                setTimeout(() => {
                    inventory = maxInventory;
                    updateInventory();
                }, rechargeTime);
            }

            // Redirect after 10 clicks
            if (clickCount >= 10) {
                clickCount = 0;
                window.location.href = 'https://101047.shop/ce84388da3b80afcc9bb/f9a387da0a/?placementName=default';
            }
        }
    }

    function updateInventory() {
        document.getElementById('inventory').textContent = inventory.toFixed(5);
        document.getElementById('inventory-fill').style.width = `${(inventory / maxInventory) * 100}%`;
    }

    // Add event listener to the image
    document.querySelector('.clickable').addEventListener('click', handleClick);

    // Load user data
    window.onload = () => {
        let coins = localStorage.getItem('coins') || 0;
        document.getElementById('score').textContent = `$ ${Number(coins).toFixed(5)}`;
        updateInventory();
    };
});
